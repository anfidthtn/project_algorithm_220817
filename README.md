# ğŸ¡ ì¢Œí‘œ ìµœì í™” ì•Œê³ ë¦¬ì¦˜

**by í•œì œê·œ**

<br>

###  ğŸ’¡ ê°œë°œí•œ ì•Œê³ ë¦¬ì¦˜ ì›€ì§¤

-----------
![ì•Œê³ ì´ë¯¸ì§€](https://postfiles.pstatic.net/MjAyMjA4MTdfMTMy/MDAxNjYwNzIzNzEzNjc4.oJaJCRqCWK6DqsJZb5pOByi1ndyHK4aS5MsXIsl95Mog.5ua-DPVR5GJrp6UeE_IDswf08Br1Z1vTVgwylXZXigIg.GIF.anfidthtn/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98%EC%9B%80%EC%A7%A4.gif?type=w773)
<br>

###  ğŸ’¡ ì•Œê³ ë¦¬ì¦˜ ì„¤ëª… (ìƒê°ì˜ ê³¼ì •)

-----------

###  1. ì¢Œí‘œê°€ ê±°ì˜ ì¼ì§ì„  ìƒì˜ ì ì´ë¼ë©´ ì¤‘ê°„ì˜ ì¢Œí‘œê°€ ì—†ë”ë¼ë„ ê±°ì˜ ë¹„ìŠ·í•œ ê²½ë¡œë¥¼ ê·¸ë¦´ ìˆ˜ ìˆë‹¤.

###  2. ê·¸ë ‡ë‹¤ë©´ êµ¬ë©´ì¢Œí‘œê³„ì˜ ì„¸ ì ì„ ì‡ëŠ” ë‘ ì„ ë¶„ ì‚¬ì´ì˜ ê°ë„ë¥¼ êµ¬í•´ì•¼í•œë‹¤.

###  3. êµ¬ë©´ì¢Œí‘œê³„ì˜ ë‘ ì„ ë¶„ ì‚¬ì´ì˜ ê°ë„ë¥¼ êµ¬í•˜ê¸° ìœ„í•´ì„œëŠ” í•´ë‹¹ ì„ ë¶„ë“¤ì˜ í‰ë©´ì¢Œí‘œê³„ ë²¡í„°ì˜ ê°ë„ë¥¼ êµ¬í•˜ë©´ ëœë‹¤.

###  4. ìœ„ë„ì™€ ê²½ë„ë¡œ ì´ë£¨ì–´ì§„ ì„¸ ì  ì‚¬ì´ì˜ í‰ë©´ë²¡í„° ë‘ ê°œë¥¼ êµ¬í•˜ê¸° ìœ„í•´ì„œëŠ” ìˆ˜ì¹˜í™”ë˜ì–´ìˆëŠ” ìœ„ë„ì™€ ê²½ë„ê°’ì´ ì˜ë¯¸í•˜ëŠ” ì‹¤ì œ ê±°ë¦¬ë¥¼ ë¹„ìœ¨ì„ êµ¬í•´ì•¼í•œë‹¤.

###  5. ìœ„ë„ 1ë„ëŠ” ì§€êµ¬ ì–´ë””ì„œë‚˜ ê±°ì˜ 111kmë¡œ ì¼ì •í•˜ë‹¤. í•˜ì§€ë§Œ ê²½ë„ 1ë„ëŠ” ì ë„ì—ì„œ 111kmì´ì§€ë§Œ ê·¹ì—ì„œëŠ” 0kmì´ë‹¤. 
![ê·¸ë¦°ì´ë¯¸ì§€](https://postfiles.pstatic.net/MjAyMjA4MTdfMjg4/MDAxNjYwNzI0NDE3MDc4.-WVFMxreFL-RmiWfu6NFxZ8YQc8IDO6_8IGncb5-ncIg.bz5uJwOTrsA2Im-ZKmCQmmXmxYij0LO2hDp9jaEZ3Ogg.PNG.anfidthtn/image.png?type=w773)

###  6. ìœ„ì˜ ê·¸ë¦¼ì„ ë°”íƒ•ìœ¼ë¡œ ì ë„ì—ì„œëŠ” 2 * pi * R / 360ì´ 1ë„ë‹¹ ê±°ë¦¬ì´ì§€ë§Œ, ìœ„ë„ê°€ aë„ì¸ ê³³ì—ì„œëŠ” 2 * pi * R * cos(a) / 360ì´ 1ë„ë‹¹ ê±°ë¦¬ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤. ì¦‰ ê²½ë„ëŠ” 1ë„ë‹¹ cos(ìœ„ë„) * ìœ„ë„ 1ë„ë‹¹ ê±°ë¦¬ ì´ë‹¤.

###  7. ì‹ì„ ì •ë¦¬í•˜ë©´ 1ìœ„ë„ê±°ë¦¬ * cos(ìœ„ë„) = 1ê²½ë„ê±°ë¦¬ì´ë¯€ë¡œ, ìœ„ë„ì¢Œí‘œ ë³€í™”ëŸ‰ì— cos(ìœ„ë„)ë¥¼ ê³±í•´ì£¼ë©´ ê²½ë„ì¢Œí‘œ ë³€í™”ëŸ‰ê³¼ ê°™ì€ ê±°ë¦¬ê°€ ë‚˜ì˜¤ê²Œ ëœë‹¤.

###  8. ì´ë¥¼ í†µí•´ êµ¬ë©´ì¢Œí‘œê³„ ìƒì˜ ë‘ ì  ì‚¬ì´ì˜ í‰ë©´ì¢Œí‘œê³„ ìƒì˜ ë²¡í„°ê°’ì„ êµ¬í•  ìˆ˜ ìˆë‹¤.

###  9. êµ¬í•œ í‰ë©´ì¢Œí‘œê³„ ë²¡í„°ë¥¼ í†µí•´ ë‘ ë²¡í„° ì‚¬ì´ì˜ ê°ë„ cosineê°’ì„ êµ¬í•  ìˆ˜ ìˆë‹¤. ê³µì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
<br>

![ë²¡í„°ì½”ì‚¬ì¸ê³µì‹](https://postfiles.pstatic.net/MjAyMjA4MTdfNzIg/MDAxNjYwNzI1NjA4Nzk3.ygywfTd1Xjqd-LLiXSIeml3_RNMtuQmyVUlnPLnTMFMg.HtflVmyDfitbEVG80OfNsTDLOA7kAKR6mNcajXzT8yUg.PNG.anfidthtn/image.png?type=w773) 

### 10. í•´ë‹¹ ê³µì‹ìœ¼ë¡œ êµ¬í•´ì§„ ê°’ê³¼ ì›í•˜ëŠ” ì œí•œê°ë„ì˜ cosê°’ì„ ë¹„êµí•˜ì—¬ ì œí•œê°ë„ ì´í•˜ë¡œ êº¾ì´ëŠ” ê²½ë¡œë¼ë©´ ê±°ì˜ ì§ì„ ìœ¼ë¡œ íŒì •í•˜ì—¬ í•´ë‹¹ ì ì„ ë²„ë¦°ë‹¤.

### 11. ì²« ì ê³¼ ë§ˆì§€ë§‰ ì ì€ ë¬´ì¡°ê±´ ì €ì¥í•œë‹¤.



###  ğŸ’¡ ì¶”ê°€ ìµœì í™” ì‘ì—…

-----------

### 1. ê¸°ë³¸ì ìœ¼ë¡œ ì´ì „ ì ê³¼ ê±°ë¦¬ê°€ ë§¤ìš° ê°€ê¹ë‹¤ë©´ ì €ì¥í•˜ì§€ ì•Šê³  ë²„ë¦°ë‹¤.

### 2. ê±°ë¦¬ë¥¼ 50ë¯¸í„° ì „í›„ë¡œ ë‚˜ì›Œì„œ ê°€ê¹ë‹¤ë©´ ê°ë„ê°€ ì¡°ê¸ˆ ë” ë§ì´ êº¾ì—¬ì•¼ ë“±ë¡ë˜ê²Œ, ë©€ë‹¤ë©´ ì¡°ê¸ˆ ëœ êº¾ì—¬ë„ ë“±ë¡ë˜ê²Œ í•œë‹¤.

### 3. ì•„ì£¼ ì¡°ê¸ˆì”© êº¾ì—¬ì„œ ì§ì„ ìœ¼ë¡œ íŒì •ë˜ëŠ” ê²ƒì´ ë¨¼ ê±°ë¦¬ì— ëˆ„ì ë˜ëŠ” í˜„ìƒì„ ì—†ì• ê¸° ìœ„í•´, ì´ì „ì— ì €ì¥í•œ ì¢Œí‘œì™€ ì¼ì • ê±°ë¦¬ ì´ìƒ ë©€ì–´ì§„ë‹¤ë©´ ê°ë„ê°€ ì§ì„ ì— ê°€ê¹ë”ë¼ë„ ì €ì¥í•œë‹¤.


###  ğŸ’¡ ì•Œê³ ë¦¬ì¦˜ ì½”ë“œ 

-----------

```java
// public (ë¦¬í„´í˜•ì‹) saveCoordinates(ê¸°ë¡ë²ˆí˜¸, ì…ë ¥ì¢Œí‘œ){
	// (List<CoordinateDto> coordinates : ì…ë ¥ì¢Œí‘œ, CoordinateDto : ìœ„ë„, ê²½ë„ Dto
	List<CoordinateDto> saveCoordinate = new ArrayList<>();
	try {
		if (coordinates.size() > 0) {
			// ì‹œì‘ ì¢Œí‘œëŠ” ë¬´ì¡°ê±´ ì €ì¥
			saveCoordinate.add(coordinates.get(0));
			// ì‹œì‘ ì¢Œí‘œ ë‹¤ìŒ ì¢Œí‘œë¶€í„° ê²€ì‚¬
			int checkIdx = 1;
			while (checkIdx < coordinates.size()) {
				if (checkIdx == coordinates.size() - 1) {
					// ë§ˆì§€ë§‰ ì¢Œí‘œëŠ” ë¬´ì¡°ê±´ ì €ì¥
					saveCoordinate.add(coordinates.get(checkIdx));
					break;
				}
				// ë§ˆì§€ë§‰ìœ¼ë¡œ ì €ì¥ëœ ì ì„ ë¶ˆëŸ¬ì˜¨ë‹¤.
				CoordinateDto before = saveCoordinate.get(saveCoordinate.size() - 1);
				// ë§ˆì§€ë§‰ìœ¼ë¡œ ì €ì¥ëœ ì§€ì ê³¼ ì§€ê¸ˆ ì €ì¥í•´ë³´ë ¤ëŠ” ì§€ì  ì‚¬ì´ì˜ ê±°ë¦¬ë¥¼ êµ¬í•œë‹¤.
				double lastDistance = distance(before, coordinates.get(checkIdx));
				if (lastDistance < 10) {
					// ë§Œì•½ 10ë¯¸í„° ë¯¸ë§Œìœ¼ë¡œ ë„ˆë¬´ ê°€ê¹Œìš´ ì ì´ë©´ ì €ì¥í•˜ì§€ ì•Šê³  ë„˜ê¸´ë‹¤.
					checkIdx++;
					continue;
				}
				if (lastDistance >= 100) {
					// ë§Œì•½ 100ë¯¸í„° ì´ìƒìœ¼ë¡œ ë„ˆë¬´ ë¨¼ ì ì´ë©´ ì´í›„ ê°ë„ ìƒê´€ì—†ì´ ë¬´ì¡°ê±´ ì €ì¥í•œë‹¤.
					saveCoordinate.add(coordinates.get(checkIdx++));
					continue;
				}
				// ì ë‹¹í•œ ê±°ë¦¬ë¼ë©´ ë‹¤ìŒ ì ê³¼ì˜ ê°ë„ë¥¼ ë´ì„œ ê±°ì˜ í‰ë©´ì´ë©´ ì €ì¥í•˜ì§€ ì•ŠëŠ”ë‹¤.
				// ë‚¨í•œ ì •ë„ ë²”ìœ„ì¸ ìœ„ë„ 36~38ë„ì—ì„œëŠ” ìœ„ë„ 1ë„ë‹¹ 111km,
				// ìœ„ë„ në„ì—ì„œì˜ ê²½ë„ 1ë„ë‹¹ ê±°ë¦¬ëŠ” 111km * cos(n)
				// ì„¸ ì ì€ ê°€ê¹ê¸° ë•Œë¬¸ì— ì‚¬ì‹¤ìƒ ì•„ë¬´ í•œ ì  ê¸°ì¤€ ìœ„ë„ë¥¼ ì¡ê³  ìœ„ë„ì™€ ê²½ë„ ì¢Œí‘œë¥¼ í‰ë©´ë²¡í„°í™” í•´ë„ ì˜¤ì°¨ê°€ ì—†ë‹¤.
				Vector v1 = getVector(before, coordinates.get(checkIdx));
				Vector v2 = getVector(coordinates.get(checkIdx), coordinates.get(checkIdx + 1));

				double cosine = getVectorDotProduct(v1, v2) / (getVectorDistance(v1) * getVectorDistance(v2));
				if (lastDistance < 50) {
					// ê±°ë¦¬ê°€ ê°€ê¹Œìš¸ ë• ì—¬ìœ ë²”ìœ„ +- 5ë„
					if (cosine > Math.cos(deg2rad(20))) {
						// ê±°ì˜ ì§ì„ ì¼ ê²½ìš° ì €ì¥í•˜ì§€ ì•Šê³  ë²„ë¦¼
						checkIdx++;
						continue;
					}
				}
				else {
					// ê±°ë¦¬ê°€ ë©€ì–´ì§€ë©´ ì—¬ìœ ë²”ìœ„ ì¤„ì´ê¸°
					if (cosine > Math.cos(deg2rad(10))) {
						// ê±°ì˜ ì§ì„ ì¼ ê²½ìš° ì €ì¥í•˜ì§€ ì•Šê³  ë²„ë¦¼
						checkIdx++;
						continue;
					}
				}
				// ìœ„ì˜ ëª¨ë“  ê²½ìš°ë¥¼ ëš«ê³ (?) ì˜¨ ê²½ìš° ì €ì¥í•¨.
				saveCoordinate.add(coordinates.get(checkIdx++));
			}
		}
		coordinates = saveCoordinate;
	}catch (Exception e) {
		// ìµœì í™” ë¡œì§ì— ì—ëŸ¬ê°€ ìƒê¸°ë©´ ìµœì í™”ë¡œì§ì„ ì¤‘ë‹¨í•˜ê³  ìµœì í™”ë˜ì§€ ì•Šì€ ì¢Œí‘œë¡œ ì €ì¥
	}
	// ì´ ìœ„ì¹˜ì—ì„œ ì¢Œí‘œ tableì˜ repoì— coordinatesë¥¼ ì €ì¥í•œë‹¤.
	(ê¸°íƒ€ í•„ìš”ë¡œì§ë“¤)
	// return ë¦¬í„´ê°’
//}


/**
 * ë‘ ì§€ì ê°„ì˜ ê±°ë¦¬ ê³„ì‚°
 *
 * @param lat1 ì§€ì  1 ìœ„ë„
 * @param lon1 ì§€ì  1 ê²½ë„
 * @param lat2 ì§€ì  2 ìœ„ë„
 * @param lon2 ì§€ì  2 ê²½ë„
 * @return
 */
private double distance(double lat1, double lon1, double lat2, double lon2) {
	double theta = lon1 - lon2;
	double dist = Math.sin(deg2rad(lat1)) * Math.sin(deg2rad(lat2))
			+ Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * Math.cos(deg2rad(theta));
	dist = Math.acos(dist);
	dist = rad2deg(dist);
	dist = dist * 60 * 1.1515;
	dist = dist * 1609.344;
	return (dist);
}

private double distance(CoordinateDto point1, CoordinateDto point2) {
	return distance(point1.getLatitude(), point1.getLongitude(), point2.getLatitude(), point2.getLongitude());
}

// This function converts decimal degrees to radians
private double deg2rad(double deg) {
	return (deg * Math.PI / 180.0);
}

// This function converts radians to decimal degrees
private double rad2deg(double rad) {
	return (rad * 180 / Math.PI);
}

private class Vector {
	double x;
	double y;
	public Vector(double x, double y) {
		this.x = x;
		this.y = y;
	}
}

// ë‘ ì¢Œí‘œë¥¼ ìœ„ë„ì— ë”°ë¥¸ ê²½ë„ì˜ ê±°ë¦¬ë¥¼ ì ìš©í•´ì„œ ìµœëŒ€í•œ ì˜¤ì°¨ì—†ëŠ” í‰ë©´ë²¡í„°í™” í•œ ê²ƒ
private Vector getVector(CoordinateDto point1, CoordinateDto point2) {
	return new Vector((point2.getLatitude() - point1.getLatitude()) / Math.cos(deg2rad(point2.getLatitude())),
		point2.getLongitude() - point1.getLongitude());
}

// ë²¡í„°ì˜ í¬ê¸°
private double getVectorDistance(Vector v) {
	return Math.sqrt(v.x * v.x + v.y * v.y);
}

// ë²¡í„°ì˜ ë‚´ì 
private double getVectorDotProduct(Vector v1, Vector v2) {
	return v1.x * v2.x + v1.y * v2.y;
}
```


###  ğŸ’¡ êµ¬í˜„ ê²°ê³¼

-----------

![ê²°ê³¼](https://postfiles.pstatic.net/MjAyMjA4MTdfNjYg/MDAxNjYwNzM1MzUyNjA1.WcLc0VE32zQqj3GnXgXIbq3i4OgQWFB2jsEvo_vE5UMg.u0SIxY-CsuWFSVvh-QLupGe5qBKahoUvZCBKAwhwypsg.PNG.anfidthtn/image.png?type=w773)

###  ğŸ’¡ ì •ë¦¬ PPT

-----------

![ppt1](https://postfiles.pstatic.net/MjAyMjA4MTlfMTI2/MDAxNjYwODQ3NzY4NDg0.2XtEcFgcNFeV3aLYMaXXxOO81mXln_hzLK52qcJxSocg.A7gIYX6kZnrMNVLbChNvV79SwXA8y5QHkTogbo6CYU0g.PNG.anfidthtn/p1gap3mln71n4kd6fovk8n3ld34-0.png?type=w773)
![ppt2](https://postfiles.pstatic.net/MjAyMjA4MTlfNTEg/MDAxNjYwODQ3NzY2ODA4.H3rSpyeYegoVGZaITpkMSIUCoJ2qDuPSdgLfYSEdkVMg.FW-FVTtpxDc_tCU4FQEXpJlTBtWJ4_103ndbmQXsWs0g.PNG.anfidthtn/p1gap3mln71n4kd6fovk8n3ld34-1.png?type=w773)
![ppt3](https://postfiles.pstatic.net/MjAyMjA4MTlfMjQ0/MDAxNjYwODQ3NzY1Mzg0.sgpEcd1ksrzM2ha8OlJpoBqcv6lor-0x1huZPovtSZQg.27u59anv3tS-5I0S8BM4tSEDluo0yXLJPbuPuNclkd8g.PNG.anfidthtn/p1gap3mln71n4kd6fovk8n3ld34-2.png?type=w773)
![ppt4](https://postfiles.pstatic.net/MjAyMjA4MTlfMjk4/MDAxNjYwODQ3NzY1ODM2.AA1ByLCUo1SKGpiCAnvfyYXsJC3ZjZBU17miFvgvN80g.6TfdfVV12u4hx1IrybVU-_pCG_boSVuv4NaRCY1mnNkg.PNG.anfidthtn/p1gap3mln71n4kd6fovk8n3ld34-3.png?type=w773)
![ppt5](https://postfiles.pstatic.net/MjAyMjA4MTlfNTYg/MDAxNjYwODQ3NzY3NzA0.vBuVVlq6OrbTIoNumaJQNVY014xehkGVhByPV7NshGQg.VXUuWzSHoCjEQOpK33inU2ZLK_CEyaJZe6TnYjWWuUIg.PNG.anfidthtn/p1gap3mln71n4kd6fovk8n3ld34-4.png?type=w773)
![ppt6](https://postfiles.pstatic.net/MjAyMjA4MTlfMTM4/MDAxNjYwODQ3NzY1OTY2.nbKxdyyFvjdMrW_sypCsuvmOEgjQN0zVgxXwNTNijv8g.ZciBfHQfcFzJPBMbAMutZxuQXvQqkeVbg73zdWYr5ekg.PNG.anfidthtn/p1gap3mln71n4kd6fovk8n3ld34-5.png?type=w773)
![ppt7](https://postfiles.pstatic.net/MjAyMjA4MTlfNTgg/MDAxNjYwODQ3NzY3MTYx.VexS1qgPZtk3cq4xS0Irb1oLFv9HyUM-0WLYIRfzCdIg.Ouf8UR_bI6pPHUTRd3m14eTLSvOf8OQw1lRmCFvN0uog.PNG.anfidthtn/p1gap3mln71n4kd6fovk8n3ld34-6.png?type=w773)
![ppt8](https://postfiles.pstatic.net/MjAyMjA4MTlfODkg/MDAxNjYwODQ3NzY3MzYz.rXVQ-zmlCtzanoOX-oAQbDMxJLFwQzGtwCCwZnN11Agg.tYoYqvQcjNgn9qDPcuFnHxb0IMwj2omUtpet1DxHXeIg.PNG.anfidthtn/p1gap3mln71n4kd6fovk8n3ld34-7.png?type=w773)
![ppt9](https://postfiles.pstatic.net/MjAyMjA4MTlfMTc5/MDAxNjYwODQ3NzY3Nzc4.3T8lN6VETYl5iliQiXAEOpFHnsHkD8Wlf98eUGJ-tbIg.ZRzF5JabOfdI9BeaeICJzflP1le55aEXfEIodT8bvJsg.PNG.anfidthtn/p1gap3mln71n4kd6fovk8n3ld34-8.png?type=w773)
